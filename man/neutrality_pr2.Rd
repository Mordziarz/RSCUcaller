% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/neutrality_pr2.R
\name{neutrality_pr2}
\alias{neutrality_pr2}
\title{Analyze Codon Usage Bias with Neutrality and PR2 Plots}
\usage{
neutrality_pr2(
  get_RSCU_out = get_RSCU_out,
  select = "",
  grouping_table = grouping_table
)
}
\arguments{
\item{get_RSCU_out}{A data frame generated by \code{\link{get_RSCU}} containing RSCU values}

\item{select}{Type of analysis: 
\itemize{
  \item "neutrality_plot" - GC12 vs GC3 regression
  \item "PR2_plot" - Parity Rule 2 visualization
}}

\item{grouping_table}{A data frame with columns \code{Species} (matching sample names)
and \code{group} (categorical grouping variable)}
}
\value{
A list containing:
\itemize{
  \item \code{table} - Data frame with calculated genomic features:
    \describe{
      \item{GC3}{Proportion of G+C at third codon positions}
      \item{GC12}{Mean G+C proportion at first and second positions}
      \item{A3_AT3}{A/(A+T) at third positions}
      \item{G3_GC3}{G/(G+C) at third positions}
    }
  \item \code{plot} - ggplot2 object of selected visualization
}
}
\description{
Generates two complementary visualizations to study codon usage bias patterns:
1) Neutrality plot (GC12 vs GC3) to assess mutation-translation balance
2) PR2 plot (A3/(A3+T3) vs G3/(G3+C3)) to detect compositional constraints
}
\details{
This function implements two established codon usage analysis methods:

**Neutrality Plot (GC12 vs GC3):**
- X-axis: GC3 (G+C content at 3rd codon positions)
- Y-axis: GC12 (average G+C at 1st+2nd positions)
- Deviation from diagonal suggests selection pressure

**PR2 Plot (Parity Rule 2):**
- X-axis: G3/(G3+C3)
- Y-axis: A3/(A3+T3)
- Deviation from (0.5,0.5) indicates compositional constraints
}
\examples{
\donttest{
data("prepared_fasta", package = "RSCUcaller")
rscu_data <- get_RSCU(prepared_fasta)
grouping_table <- data.frame(
  Species = unique(rscu_data$Species),
  group = rep(c("Group1", "Group2"), length.out = length(unique(rscu_data$Species)))
)

# Generate PR2 plot
pr2_result <- neutrality_pr2(
  get_RSCU_out = rscu_data,
  select = "PR2_plot",
  grouping_table = grouping_table
)

# Generate Neutrality plot
neutrality_result <- neutrality_pr2(
  get_RSCU_out = rscu_data,
  select = "neutrality_plot",
  grouping_table = grouping_table
)
}

}
\references{
Sueoka, N. (1999). Translation-coupled violation of Parity Rule 2 in human genes is not the cause of heterogeneity of the DNA G+C content of third codon position. Gene, 238(1), 53-58.
}
\seealso{
Related analysis functions:
\code{\link{get_RSCU}}, \code{\link{heatmap_RSCU}}, \code{\link{PCA_RSCU}}
}
